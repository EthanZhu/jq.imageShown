$.fn.extend($.imageShown,{_buildImageShown:function(a,b,c){var d=this,e=d._getInst(a);e.build=!0;var f=e.$elem.find("li."+d._g(e,"_item")),g=e.$elem.find("li."+d._g(e,"_pitem")),h=[];if(typeof f[0]=="undefined"&&typeof g[0]=="undefined")return;d._optionImageShown(a,b,c),d._g(e,"preload")?d._extendRemove(e.settings,{preload:!1}):"";var j,k;j=d._g(e,"player"),typeof g[0]!="undefined"?k=g.length:j?(j=!1,d._extendRemove(e.settings,{player:!1})):"",typeof f[0]!="undefined"?k=f.length:d._g(e,"tContent")=="image"?d._extendRemove(e.settings,{tContent:"none"}):"";if(typeof f[0]=="undefined"&&!j)return;var l=d._g(e,"tContent"),m=d._g(e,"pContent"),n,o,p,q,r,s,t,u,v,w=d._g(e,"showTips"),x=function(a,b,c,d){typeof c[0]!="undefined"?(c=c.html(),c.charAt(c.length-1)!="/"?c+="/":""):"";if(b=="num"||b=="none")return;var e,f,g,h,i,j=[],k,l;if(b!="hgroup"&b!="btn"&&b!="ot")return e=a.find("a:first"),f=a.find("img"),h=e[0],i=f[0],j.push("{"),typeof h!="undefined"&&b!="content"&&(l=h.href,l.charAt(l.length-1)!="/"?l+="/":"",l!=c?(j.push('"l":"'+h.href+'"'),h.target?j.push('"t":"'+h.target+'"'):""):""),b=="content"?j.push('"p":"'+a.html()+'"'):typeof i!="undefined"?(j.push('"p":"'+i.src+'"'),i.alt?j.push('"a":"'+i.alt+'"'):"",d!="big"?(i.width?j.push('"w":"'+i.width+'"'):"",i.height?j.push('"h":"'+i.height+'"'):""):""):"",j.push("}"),j.join(",");if(b=="hgroup")return e=a.find("a:first"),h=e[0],f=typeof h!="undefined"?e.html():a.html(),typeof h!="undefined"?(j.push("{"),j.push('"t":"'+f+'"'),l=h.href,l.charAt(l.length-1)!="/"?l+="/":"",l!=c?(j.push('"l":"'+h.href+'"'),h.target?j.push('"g":"'+h.target+'"'):""):"",j.push("}")):j.push('"'+f+'"'),j.join(",");if(b=="btn"){e=a.find("a"),f=e[0];if(typeof f!="undefined"){g=e.length,g==1?"":j.push("[");for(k=0;k<g;k++)j.push("{"),h=e.eq(k),i=h[0],l=i.href,i.className!=""?j.push('"c":"'+i.className+'"'):"",l.charAt(l.length-1)!="/"?l+="/":"",l!=c?(j.push('"l":"'+l+'"'),i.target?j.push('"t":"'+i.target+'"'):""):"",h.html()!=""?j.push('"t_":"'+h.html()+'"'):"",j.push("}");g==1?"":j.push("]")}else e=a.html(),e!=""?j.push('"'+e+'"'):"";return j.join(",")}if(b=="ot"){var m,n=a.length;n==1?"":j.push("[");for(m=0;m<n;m++){e=a.eq(m),e=e.find("span"),f=e[0],f=typeof f!="undefined"?e.html():"",j.push("{"),j.push('"n":"'+f+'"'),e=a.eq(m).find("a"),f=e[0],console.log(e);if(typeof f!="undefined"){j.push('"list":'),g=e.length,g==1?"":j.push("[");for(k=0;k<g;k++)j.push("{"),h=e.eq(k),i=h[0],l=i.href,h.html()!=""?(j.push('"t":"'+h.html()+'"'),l.charAt(l.length-1)!="/"?l+="/":"",l!=c?(j.push('"l":"'+l+'"'),i.target?j.push('"g":"'+i.target+'"'):""):""):"",j.push("}");g==1?"":j.push("]")}j.push("}")}n==1?"":j.push("]")}return j.join(",")},y=d._g(e,"pType"),z=d._g(e,"tipsBtn");for(i=0;i<k;i++){var A=[];A.push("{"),typeof f[0]!="undefined"?o=f.eq(i):"",typeof g[0]!="undefined"?q=g.eq(i):"",o&&(n=o.find("p.global-link"),typeof n[0]!="undefined"?A.push('"l":"'+n.html()+'"'):"",$content=o.find("p.this-content"),p=typeof $content[0]!="undefined"?x($content,l,n):'""',A.push('"s":'+p)),q&&j&&(typeof n[0]=="undefined"?(n=q.find("p.global-link"),typeof n[0]!="undefined"?A.push('"l":"'+n.html()+'"'):""):"",$content=q.find("p.this-content"),p=typeof $content[0]!="undefined"?x($content,l,n,"big"):'""',A.push('"b":'+p),w&&(v=q.find("label"),t=v.find("h2"),u=v.find("h3"),typeof q[0]!="undefined"?(p=typeof t[0]!="undefined"?x(t,"hgroup",n):"",p!=""?A.push('"t":'+p):"",p=typeof u[0]!="undefined"?x(u,"hgroup",n):"",p!=""?A.push('"t1":'+p):"",$content=v.find("p.tip-message"),typeof $content[0]!="undefined"?A.push('"m":"'+$content.html()+'"'):"",y?($content=v.find("p.play-type"),typeof $content[0]!="undefined"?A.push('"tp":"'+$content.html()+'"'):""):"",z?($content=v.find("p.tip-btns"),p=typeof $content[0]!="undefined"?x($content,"btn",n):"",p!=""?A.push('"b_":'+p):""):"",$content=v.find("p.other-titles"),p=typeof $content[0]!="undefined"?x($content,"ot",n):"",p!=""?A.push('"ot":'+p):""):"")),A.push("}"),p=A.join(",").replace(/{,/g,"{").replace(/,}/g,"}").replace(/\[,/g,"[").replace(/,]/g,"]").replace(/:,/g,":"),h.push(p)}e.data="["+h.join(",")+"]",e.data?d._updateImageShown(e):""}})